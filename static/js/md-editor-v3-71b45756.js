import{_ as Y}from"./@codemirror-677c9eee.js";import{f as P,w as Z}from"./@vavt-1e0d8422.js";import{v as ee}from"./medium-zoom-7d13b158.js";import{y as te}from"./copy-to-clipboard-0adce039.js";import{b as ne}from"./markdown-it-36ae1886.js";import{r as le}from"./markdown-it-image-figures-6b4113de.js";import{k as oe}from"./markdown-it-task-lists-fa532b88.js";import{$ as ie}from"./lru-cache-c40147b1.js";import{I as F,A as V,W as w,B as x,F as ae,H as j,i as L,e as T,w as E,t as G,d as q,n as O,s as R,_ as re}from"./@vue-de80bf49.js";import"./@lezer-d451e47d.js";const f="md-editor",se="md-editor-v3",de="https://at.alicdn.com/t/c/font_2605852_u82y61ve02.js",y="https://cdnjs.cloudflare.com/ajax/libs",ce=`${y}/highlight.js/11.7.0/highlight.min.js`,ue=["bold","underline","italic","strikeThrough","-","title","sub","sup","quote","unorderedList","orderedList","task","-","codeRow","code","link","image","table","mermaid","katex","-","revoke","next","save","=","prettier","pageFullscreen","fullscreen","preview","htmlPreview","catalog","github"],pe=["markdownTotal","=","scrollSwitch"],N={"zh-CN":{toolbarTips:{bold:"加粗",underline:"下划线",italic:"斜体",strikeThrough:"删除线",title:"标题",sub:"下标",sup:"上标",quote:"引用",unorderedList:"无序列表",orderedList:"有序列表",task:"任务列表",codeRow:"行内代码",code:"块级代码",link:"链接",image:"图片",table:"表格",mermaid:"mermaid图",katex:"katex公式",revoke:"后退",next:"前进",save:"保存",prettier:"美化",pageFullscreen:"浏览器全屏",fullscreen:"屏幕全屏",preview:"预览",htmlPreview:"html代码预览",catalog:"目录",github:"源码地址"},titleItem:{h1:"一级标题",h2:"二级标题",h3:"三级标题",h4:"四级标题",h5:"五级标题",h6:"六级标题"},imgTitleItem:{link:"添加链接",upload:"上传图片",clip2upload:"裁剪上传"},linkModalTips:{linkTitle:"添加链接",imageTitle:"添加图片",descLabel:"链接描述：",descLabelPlaceHolder:"请输入描述...",urlLabel:"链接地址：",urlLabelPlaceHolder:"请输入链接...",buttonOK:"确定"},clipModalTips:{title:"裁剪图片上传",buttonUpload:"上传"},copyCode:{text:"复制代码",successTips:"已复制！",failTips:"复制失败！"},mermaid:{flow:"流程图",sequence:"时序图",gantt:"甘特图",class:"类图",state:"状态图",pie:"饼图",relationship:"关系图",journey:"旅程图"},katex:{inline:"行内公式",block:"块级公式"},footer:{markdownTotal:"字数",scrollAuto:"同步滚动"}},"en-US":{toolbarTips:{bold:"bold",underline:"underline",italic:"italic",strikeThrough:"strikeThrough",title:"title",sub:"subscript",sup:"superscript",quote:"quote",unorderedList:"unordered list",orderedList:"ordered list",task:"task list",codeRow:"inline code",code:"block-level code",link:"link",image:"image",table:"table",mermaid:"mermaid",katex:"formula",revoke:"revoke",next:"undo revoke",save:"save",prettier:"prettier",pageFullscreen:"fullscreen in page",fullscreen:"fullscreen",preview:"preview",htmlPreview:"html preview",catalog:"catalog",github:"source code"},titleItem:{h1:"Lv1 Heading",h2:"Lv2 Heading",h3:"Lv3 Heading",h4:"Lv4 Heading",h5:"Lv5 Heading",h6:"Lv6 Heading"},imgTitleItem:{link:"Add Img Link",upload:"Upload Img",clip2upload:"Clip Upload"},linkModalTips:{linkTitle:"Add Link",imageTitle:"Add Image",descLabel:"Desc:",descLabelPlaceHolder:"Enter a description...",urlLabel:"Link:",urlLabelPlaceHolder:"Enter a link...",buttonOK:"OK"},clipModalTips:{title:"Crop Image",buttonUpload:"Upload"},copyCode:{text:"Copy",successTips:"Copied!",failTips:"Copy failed!"},mermaid:{flow:"flow",sequence:"sequence",gantt:"gantt",class:"class",state:"state",pie:"pie",relationship:"relationship",journey:"journey"},katex:{inline:"inline",block:"block"},footer:{markdownTotal:"Word Count",scrollAuto:"Scroll Auto"}}},me=`${y}/mermaid/10.1.0/mermaid.esm.min.mjs`,z={js:`${y}/KaTeX/0.16.3/katex.min.js`,css:`${y}/KaTeX/0.16.3/katex.min.css`},K={a11y:{light:`${y}/highlight.js/11.7.0/styles/a11y-light.min.css`,dark:`${y}/highlight.js/11.7.0/styles/a11y-dark.min.css`},atom:{light:`${y}/highlight.js/11.7.0/styles/atom-one-light.min.css`,dark:`${y}/highlight.js/11.7.0/styles/atom-one-dark.min.css`},github:{light:`${y}/highlight.js/11.7.0/styles/github.min.css`,dark:`${y}/highlight.js/11.7.0/styles/github-dark.min.css`},gradient:{light:`${y}/highlight.js/11.7.0/styles/gradient-light.min.css`,dark:`${y}/highlight.js/11.7.0/styles/gradient-dark.min.css`},kimbie:{light:`${y}/highlight.js/11.7.0/styles/kimbie-light.min.css`,dark:`${y}/highlight.js/11.7.0/styles/kimbie-dark.min.css`},paraiso:{light:`${y}/highlight.js/11.7.0/styles/paraiso-light.min.css`,dark:`${y}/highlight.js/11.7.0/styles/paraiso-dark.min.css`},qtcreator:{light:`${y}/highlight.js/11.7.0/styles/qtcreator-light.min.css`,dark:`${y}/highlight.js/11.7.0/styles/qtcreator-dark.min.css`},stackoverflow:{light:`${y}/highlight.js/11.7.0/styles/stackoverflow-light.min.css`,dark:`${y}/highlight.js/11.7.0/styles/stackoverflow-dark.min.css`}},H={editorExtensions:{},editorConfig:{},codeMirrorExtensions:(e,t)=>t,markdownItConfig:()=>{}};var he=Object.defineProperty,ge=(e,t,l)=>t in e?he(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,fe=(e,t,l)=>(ge(e,typeof t!="symbol"?t+"":t,l),l);class ve{constructor(){fe(this,"pools",{})}remove(t,l,i){const n=this.pools[t]&&this.pools[t][l];n&&(this.pools[t][l]=n.filter(s=>s!==i))}clear(t){this.pools[t]={}}on(t,l){return this.pools[t]||(this.pools[t]={}),this.pools[t][l.name]||(this.pools[t][l.name]=[]),this.pools[t][l.name].push(l.callback),this.pools[t][l.name].includes(l.callback)}emit(t,l,...i){this.pools[t]||(this.pools[t]={});const n=this.pools[t][l];n&&n.forEach(s=>{try{s(...i)}catch(a){console.error(`${l} monitor event exception！`,a)}})}}const S=new ve,ke=e=>{if(!e)return e;const t=e.split(`
`),l=['<span rn-wrapper aria-hidden="true">'];return t.forEach(()=>{l.push("<span></span>")}),l.push("</span>"),`<span class="code-block">${e}</span>${l.join("")}`},ye=(e,t)=>{if(!e||!t)return 0;const l=e==null?void 0:e.getBoundingClientRect();if(t===document.documentElement)return l.top-t.clientTop;const i=t==null?void 0:t.getBoundingClientRect();return l.top-i.top},be=()=>`${Date.now().toString(36)}${Math.random().toString(36).substring(2)}`,M=(e,t="")=>{const l=document.getElementById(e.id),i=e.onload;e.onload=null;const n=function(s){typeof i=="function"&&i.bind(this)(s),e.removeEventListener("load",n)};l?t!==""&&(l.addEventListener("load",n),Reflect.get(window,t)&&l.dispatchEvent(new Event("load"))):(e.addEventListener("load",n),document.head.appendChild(e))},$e=P((e,t,l)=>{const i=document.getElementById(e);i&&i.setAttribute(t,l)},10),we=(e,t)=>{const l=x("editorId"),i=P(()=>{const n=document.querySelectorAll(`#${l}-preview img`);n.length!==0&&ee(n,{background:"#00000073"})});T(i),E([t,G(e.setting,"preview")],i)},xe=we,Ce=(e,t)=>{const l=x("editorId"),i=x("usedLanguageText"),n=()=>{document.querySelectorAll(`#${l}-preview pre`).forEach(c=>{var u,r;let o=-1;(u=c.querySelector(".copy-button"))==null||u.remove();const d=((r=i.value.copyCode)==null?void 0:r.text)||"复制代码",m=document.createElement("span");m.setAttribute("class","copy-button"),m.dataset.tips=d,m.innerHTML=`<svg class="${f}-icon" aria-hidden="true"><use xlink:href="#${f}-icon-copy"></use></svg>`,m.addEventListener("click",()=>{var k,p;clearTimeout(o);const g=c.querySelector("code").innerText,h=te(e.formatCopiedText(g)),b=((k=i.value.copyCode)==null?void 0:k.successTips)||"已复制！",v=((p=i.value.copyCode)==null?void 0:p.failTips)||"已复制！";m.dataset.tips=h?b:v,o=window.setTimeout(()=>{m.dataset.tips=d},1500)}),c.appendChild(m)})},s=()=>{O(n)},a=c=>{c&&O(n)};E(()=>t.value,s),E(()=>e.setting.preview,a),E(()=>e.setting.htmlPreview,a),E(()=>i.value,n),T(n)},Te=Ce,Ee=e=>{var t;const l=(t=H.editorExtensions)==null?void 0:t.highlight,i=l==null?void 0:l.instance,n=x("highlight"),s=R(i);return T(()=>{if(!e.noHighlight&&!s.value){const a=document.createElement("script");a.src=n.value.js,a.onload=()=>{s.value=window.hljs},a.id=`${f}-hljs`,M(a,"hljs");const c=document.createElement("link");c.rel="stylesheet",c.href=n.value.css,c.id=`${f}-hlCss`,M(c)}}),E(()=>n.value.css,a=>{$e(`${f}-hlCss`,"href",a)}),s},Ie=Ee,Se=e=>{const t=x("theme"),{editorExtensions:l}=H,i=l==null?void 0:l.mermaid,n=R(i==null?void 0:i.instance),s=R(!1),a=new ie({max:1e3,ttl:6e5}),c=()=>{const u=n.value;!e.noMermaid&&u&&(u.initialize({startOnLoad:!1,theme:t.value==="dark"?"dark":"default"}),s.value=!s.value)};return E(()=>t.value,()=>{a.clear(),c()}),T(()=>{if(!e.noMermaid&&!(i!=null&&i.instance)){const u=(i==null?void 0:i.js)||me;if(/\.mjs/.test(u))Y(()=>import(u),[]).then(r=>{n.value=r.default,c()});else{const r=document.createElement("script");r.id=`${f}-mermaid`,r.src=u,r.onload=()=>{n.value=window.mermaid,c()},M(r,"mermaid")}}}),{mermaidRef:n,reRenderRef:s,replaceMermaid:()=>{O(()=>{if(!e.noMermaid&&n.value){const u=document.querySelectorAll(`div.${f}-mermaid`),r=document.createElement("div");r.style.width=document.body.offsetWidth+"px",r.style.height=document.body.offsetHeight+"px",r.style.position="fixed",r.style.zIndex="-10000",r.style.top="-10000";let o=u.length;o>0&&document.body.appendChild(r),u.forEach(async d=>{let m=a.get(d.innerText);if(!m){const p=be(),g=n.value.renderAsync||n.value.render;let h="";try{h=await g(p,d.innerText,r)}catch{}m=typeof h=="string"?h:h.svg,a.set(d.innerText,m)}const k=document.createElement("p");k.className=`${f}-mermaid`,k.setAttribute("data-processed",""),k.innerHTML=m,d.dataset.line!==void 0&&(k.dataset.line=d.dataset.line),d.replaceWith(k),--o===0&&r.remove()})}})}}},He=Se,_e=e=>{var t;const l=(t=H.editorExtensions)==null?void 0:t.katex,i=l==null?void 0:l.instance,n=R(i);return T(()=>{if(!e.noKatex&&!n.value){const s=document.createElement("script");s.src=(l==null?void 0:l.js)||z.js,s.onload=()=>{n.value=window.katex},s.id=`${f}-katex`;const a=document.createElement("link");a.rel="stylesheet",a.href=(l==null?void 0:l.css)||z.css,a.id=`${f}-katexCss`,M(s,"katex"),M(a)}}),n},je=_e,Le=(e,t)=>{const l=e.renderer.rules.fence.bind(e.renderer.rules);e.renderer.rules.fence=(i,n,s,a,c)=>{const u=i[n],r=u.content.trim();if(u.info==="mermaid"&&!t.noMermaid){let o;return i[n].map&&i[n].level===0&&(o=i[n].map[0],i[n].attrSet("data-line",String(o))),`<div class="${f}-mermaid" ${o!==void 0?"data-line="+o:""} data-mermaid-theme=${t.themeRef.value}>${r}</div>`}return l(i,n,s,a,c)}},Me=Le,U=(e,t)=>{let l=!0,i=!0;const n=e.posMax,s=t>0?e.src.charCodeAt(t-1):-1,a=t+1<=n?e.src.charCodeAt(t+1):-1;return(s===32||s===9||a>=48&&a<=57)&&(i=!1),(a===32||a===9)&&(l=!1),{can_open:l,can_close:i}},Re=(e,t)=>{let l,i,n,s;if(e.src[e.pos]!=="$")return!1;if(n=U(e,e.pos),!n.can_open)return t||(e.pending+="$"),e.pos+=1,!0;const a=e.pos+1;for(l=a;(l=e.src.indexOf("$",l))!==-1;){for(s=l-1;e.src[s]==="\\";)s-=1;if((l-s)%2==1)break;l+=1}return l===-1?(t||(e.pending+="$"),e.pos=a,!0):l-a===0?(t||(e.pending+="$$"),e.pos=a+1,!0):(n=U(e,l),n.can_close?(t||(i=e.push("math_inline","math",0),i.markup="$",i.content=e.src.slice(a,l)),e.pos=l+1,!0):(t||(e.pending+="$"),e.pos=a,!0))},Fe=(e,t,l,i)=>{let n,s,a,c,u=!1,r=e.bMarks[t]+e.tShift[t],o=e.eMarks[t];if(r+2>o||e.src.slice(r,r+2)!=="$$")return!1;if(r+=2,n=e.src.slice(r,o),i)return!0;for(n.trim().slice(-2)==="$$"&&(n=n.trim().slice(0,-2),u=!0),a=t;!u&&(a++,!(a>=l||(r=e.bMarks[a]+e.tShift[a],o=e.eMarks[a],r<o&&e.tShift[a]<e.blkIndent)));)e.src.slice(r,o).trim().slice(-2)==="$$"&&(c=e.src.slice(0,o).lastIndexOf("$$"),s=e.src.slice(r,c),u=!0);e.line=a+1;const d=e.push("math_block","math",0);return d.block=!0,d.content=(n&&n.trim()?n+`
`:"")+e.getLines(t+1,a,e.tShift[t],!0)+(s&&s.trim()?s:""),d.map=[t,e.line],d.markup="$$",!0},Ae=(e,t)=>{const l=n=>{if(t.katexRef.value){const s=t.katexRef.value.renderToString(n,{throwOnError:!1});return`<span class="${f}-katex-inline" data-processed>${s}</span>`}else return`<span class="${f}-katex-inline">${n}</span>`},i=(n,s)=>{if(t.katexRef.value){const a=t.katexRef.value.renderToString(n,{throwOnError:!1,displayMode:!0});return`<p class="${f}-katex-block" data-line=${s} data-processed>${a}</p>`}else return`<p class="${f}-katex-block" data-line=${s}>${n}</p>`};e.inline.ruler.after("escape","math_inline",Re),e.block.ruler.after("blockquote","math_block",Fe,{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.math_inline=(n,s)=>l(n[s].content),e.renderer.rules.math_block=(n,s)=>i(n[s].content,n[s].map[0])+`
`},Be=Ae,Oe=(e,t)=>{t=t||{};const l=3,i=t.marker||"!",n=i.charCodeAt(0),s=i.length;let a="",c="";const u=(o,d,m,k,p)=>{const g=o[d];return g.type==="admonition_open"?(o[d].attrPush(["class",`${f}-admonition ${f}-admonition-${g.info}`]),o[d].attrSet("data-line",String(o[d].map[0]))):g.type==="admonition_title_open"&&o[d].attrPush(["class",`${f}-admonition-title`]),p.renderToken(o,d,m)},r=o=>{const d=o.trim().split(" ",2);c="",a=d[0],d.length>1&&(c=o.substring(a.length+2)),(c===""||!c)&&(c=a)};e.block.ruler.before("code","admonition",(o,d,m,k)=>{let p,g,h,b=!1,v=o.bMarks[d]+o.tShift[d],$=o.eMarks[d];if(n!==o.src.charCodeAt(v))return!1;for(p=v+1;p<=$&&i[(p-v)%s]===o.src[p];p++);const I=Math.floor((p-v)/s);if(I!==l)return!1;p-=(p-v)%s;const _=o.src.slice(v,p),C=o.src.slice(p,$);if(r(C),k)return!0;for(g=d;g++,!(g>=m||(v=o.bMarks[g]+o.tShift[g],$=o.eMarks[g],v<$&&o.sCount[g]<o.blkIndent));)if(n===o.src.charCodeAt(v)&&!(o.sCount[g]-o.blkIndent>=4)){for(p=v+1;p<=$&&i[(p-v)%s]===o.src[p];p++);if(!(Math.floor((p-v)/s)<I)&&(p-=(p-v)%s,p=o.skipSpaces(p),!(p<$))){b=!0;break}}const J=o.parentType,Q=o.lineMax;return o.parentType="root",o.lineMax=g,h=o.push("admonition_open","div",1),h.markup=_,h.block=!0,h.info=a,h.map=[d,g],h=o.push("admonition_title_open","p",1),h.markup=_+" "+a,h.map=[d,g],h=o.push("inline","",0),h.content=c,h.map=[d,o.line-1],h.children=[],h=o.push("admonition_title_close","p",-1),h.markup=_+" "+a,o.md.block.tokenize(o,d+1,g),h=o.push("admonition_close","div",-1),h.markup=o.src.slice(v,p),h.block=!0,o.parentType=J,o.lineMax=Q,o.line=g+(b?1:0),!0},{alt:["paragraph","reference","blockquote","list"]}),e.renderer.rules.admonition_open=u,e.renderer.rules.admonition_title_open=u,e.renderer.rules.admonition_title_close=u,e.renderer.rules.admonition_close=u},Pe=Oe,qe=(e,t)=>{e.renderer.rules.heading_open=(l,i)=>{const n=l[i],s=l[i+1].content,a=n.markup.length;return t.headsRef.value.push({text:s,level:a}),n.map&&n.level===0&&(n.attrSet("data-line",String(n.map[0])),n.attrSet("id",t.mdHeadingId(s,a,t.headsRef.value.length))),e.renderer.renderToken(l,i,t)},e.renderer.rules.heading_close=(l,i,n,s,a)=>a.renderToken(l,i,n)},Ne=qe,ze=(e,t)=>{const l=e.renderer.rules.fence,i=e.utils.unescapeAll,n=/\[(\w*)(?::([\w ]*))?\]/;function s(r){return r.info?i(r.info).trim():""}function a(r){const o=s(r),[d=null,m=""]=(n.exec(o)||[]).slice(1);return[d,m]}function c(r){const o=s(r);return o?o.split(/(\s+)/g)[0]:""}const u=(r,o,d,m,k)=>{if(r[o].hidden)return"";const[p,g]=a(r[o]);if(p===null)return l(r,o,d,m,k);let h,b,v,$,I="",_="";for(let C=o;C<r.length&&(h=r[C],[b,v]=a(h),b===p);C++)h.info=h.info.replace(n,""),h.hidden=!0,$=C-o>0?"":" checked",I+=`<li><input type="radio" name="label-group-${t.editorId}-${o}"${$}><label for="group-${t.editorId}-${o}-tab-${C-o}" onclick="this.previousElementSibling.click()">${v||c(h)}</label></li>
`,_+=`<input type="radio" id="group-${t.editorId}-${o}-tab-${C-o}" name="group-${t.editorId}-${o}"${$}>
`+l(r,C,d,m,k);return`<div class="code-tabs">
<ul>
`+I+`</ul>
`+_+"</div>"};e.renderer.rules.fence=u},Ke=ze,Ue=e=>{["paragraph_open","table_open","ordered_list_open","bullet_list_open","blockquote_open","hr","html_block","fence"].forEach(t=>{const l=e.renderer.rules[t];l?e.renderer.rules[t]=(i,n,s,a,c)=>{let u;const r=l(i,n,s,a,c);return i[n].map&&i[n].level===0?(u=i[n].map[0],r.replace(/^(<[^>]*)/,`$1 data-line="${u}"`)):r}:e.renderer.rules[t]=(i,n,s,a,c)=>{let u;return i[n].map&&i[n].level===0&&(u=i[n].map[0],i[n].attrSet("data-line",String(u))),c.renderToken(i,n,s)}})},Ve=(e,t)=>{const{editorConfig:l,markdownItConfig:i}=H,n=x("editorId"),s=x("showCodeRowNumber"),a=x("theme"),c=q([]),u=Ie(e),r=je(e),{reRenderRef:o,replaceMermaid:d}=He(e),m=ne({html:!0,breaks:!0});i(m),m.use(Be,{katexRef:r}),m.use(le,{figcaption:!0}),m.use(Pe),m.use(oe),m.use(Ne,{mdHeadingId:e.mdHeadingId,headsRef:c}),m.use(Ke,{editorId:n}),e.noMermaid||m.use(Me,{themeRef:a,noMermaid:e.noMermaid}),m.set({highlight:(b,v)=>{let $;!e.noHighlight&&u.value?u.value.getLanguage(v)?$=u.value.highlight(b,{language:v,ignoreIllegals:!0}).value:$=u.value.highlightAuto(b).value:$=m.utils.escapeHtml(b);const I=s?ke($.trim()):`<span class="code-block">${$.trim()}</span>`;return`<pre><code class="language-${v}" language=${v}>${I}</code></pre>`}}),Ue(m);const k=q(e.sanitize(m.render(e.modelValue))),p=()=>{S.emit(n,"buildFinished",k.value),e.onHtmlChanged(k.value),e.onGetCatalog(c.value),S.emit(n,"catalogChanged",c.value),d()};T(p);const g=P(async()=>{c.value=[],k.value=e.sanitize(m.render(e.modelValue)),p()},(l==null?void 0:l.renderDelay)!==void 0?l==null?void 0:l.renderDelay:t?0:500),h=L(()=>(e.noKatex||r.value)&&(e.noHighlight||u.value));return E([G(e,"modelValue"),h,o],g),T(()=>{S.on(n,{name:"pushCatalog",callback(){S.emit(n,"catalogChanged",c.value)}})}),{html:k}},Ge=Ve,De={modelValue:{type:String,default:""},setting:{type:Object,default:()=>({})},onHtmlChanged:{type:Function,default:()=>{}},onGetCatalog:{type:Function,default:()=>{}},mdHeadingId:{type:Function,default:()=>""},noMermaid:{type:Boolean,default:!1},sanitize:{type:Function,default:e=>e},noKatex:{type:Boolean,default:!1},formatCopiedText:{type:Function,default:e=>e},noHighlight:{type:Boolean,default:!1},previewOnly:{type:Boolean,default:!1}},We=F({name:"ContentPreview",props:De,setup(e){const t=x("editorId"),l=x("previewTheme"),i=x("showCodeRowNumber"),{html:n}=Ge(e,e.previewOnly);return Te(e,n),xe(e,n),()=>w(ae,null,[w("div",{id:`${t}-preview-wrapper`,class:`${f}-preview-wrapper`,"data-show":e.setting.preview,key:"content-preview-wrapper"},[w("article",{id:`${t}-preview`,class:[`${f}-preview`,`${l==null?void 0:l.value}-theme`,i&&`${f}-scrn`],innerHTML:n.value},null)]),!e.previewOnly&&w("div",{id:`${t}-html-wrapper`,class:`${f}-preview-wrapper`,"data-show":e.setting.htmlPreview,key:"html-preview-wrapper"},[w("div",{class:`${f}-html`},[n.value])])])}}),Xe=e=>{var t,l;const{editorId:i}=e,n=(l=(t=H)==null?void 0:t.editorExtensions)==null?void 0:l.highlight;j("editorId",i),j("theme",L(()=>e.theme)),j("highlight",L(()=>{const a={...K,...n==null?void 0:n.css},c=e.codeStyleReverse&&e.codeStyleReverseList.includes(e.previewTheme)?"dark":e.theme;return{js:(n==null?void 0:n.js)||ce,css:a[e.codeTheme]?a[e.codeTheme][c]:K.atom[c]}})),j("showCodeRowNumber",e.showCodeRowNumber);const s=L(()=>{var a,c;const u={...N,...(c=(a=H)==null?void 0:a.editorConfig)==null?void 0:c.languageUserDefined};return u[e.language]?u[e.language]:N["zh-CN"]});j("usedLanguageText",s),j("previewTheme",L(()=>e.previewTheme))},Je=e=>{T(()=>{var t;const l=document.createElement("script");l.src=((t=H.editorExtensions)==null?void 0:t.iconfont)||de,l.id=`${f}-icon`,e.noIconfont||M(l)})},Qe=e=>e,D={modelValue:{type:String,default:""},theme:{type:String,default:"light"},class:{type:String,default:""},language:{type:String,default:"zh-CN"},onHtmlChanged:{type:Function},onGetCatalog:{type:Function},editorId:{type:String,default:se},showCodeRowNumber:{type:Boolean,default:!1},previewTheme:{type:String,default:"default"},style:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:Qe},sanitize:{type:Function,default:e=>e},noMermaid:{type:Boolean,default:!1},noKatex:{type:Boolean,default:!1},codeTheme:{type:String,default:"atom"},noIconfont:{type:Boolean},formatCopiedText:{type:Function,default:e=>e},codeStyleReverse:{type:Boolean,default:!0},codeStyleReverseList:{type:Array,default:["default","mk-cute"]},noHighlight:{type:Boolean,default:!1}};({...D});const W=["onHtmlChanged","onGetCatalog"];[...W];const Ye=F({name:"MdPreview",props:D,emits:W,setup(e,t){const{editorId:l,noKatex:i,noMermaid:n,noHighlight:s}=e;return Xe(e),Je(e),V(()=>{S.clear(l)}),()=>w("div",{id:l,class:[f,e.class,e.theme==="dark"&&`${f}-dark`,`${f}-previewOnly`],style:e.style},[w(We,{modelValue:e.modelValue,onHtmlChanged:a=>{e.onHtmlChanged?e.onHtmlChanged(a):t.emit("onHtmlChanged",a)},onGetCatalog:a=>{e.onGetCatalog?e.onGetCatalog(a):t.emit("onGetCatalog",a)},mdHeadingId:e.mdHeadingId,noMermaid:n,sanitize:e.sanitize,noKatex:i,formatCopiedText:e.formatCopiedText,noHighlight:s,previewOnly:!0},null)])}}),A=Ye;A.install=e=>(e.component(A.name,A),e);const Ze={tocItem:{type:Object,default:()=>({})},mdHeadingId:{type:Function,default:()=>{}},scrollElement:{type:[String,Object],default:""},onClick:{type:Function,default:()=>{}},scrollElementOffsetTop:{type:Number,default:0}},X=F({props:Ze,setup(e){return()=>{const{tocItem:t,mdHeadingId:l,scrollElement:i,onClick:n,scrollElementOffsetTop:s}=e;return w("div",{class:[`${f}-catalog-link`,t.active&&`${f}-catalog-active`],onClick:a=>{n(a,t),a.stopPropagation();const c=l(t.text,t.level,t.index),u=document.getElementById(c),r=i instanceof Element?i:document.querySelector(i);if(u&&r){let o=u.offsetParent,d=u.offsetTop;if(r.contains(o))for(;o&&r!=o;)d+=o==null?void 0:o.offsetTop,o=o==null?void 0:o.offsetParent;r==null||r.scrollTo({top:d-s,behavior:"smooth"})}}},[w("span",{title:t.text},[t.text]),w("div",{class:`${f}-catalog-wrapper`},[t.children&&t.children.map(a=>w(X,{mdHeadingId:l,key:`${t.text}-link-${a.level}-${a.text}`,tocItem:a,scrollElement:i,onClick:n,scrollElementOffsetTop:s},null))])])}}}),et=X,tt={editorId:{type:String},class:{type:String,default:""},mdHeadingId:{type:Function,default:e=>e},scrollElement:{type:[String,Object]},theme:{type:String,default:"light"},offsetTop:{type:Number,default:20},scrollElementOffsetTop:{type:Number,default:0},onClick:{type:Function}},nt=F({name:"MdCatalog",props:tt,emits:["onClick"],setup(e,t){const l=e.editorId,i=re({list:[],show:!1,scrollElement:e.scrollElement||`#${l}-preview-wrapper`}),n=R(),s=L(()=>{const r=[];return i.list.forEach((o,d)=>{const{text:m,level:k}=o,p={level:k,text:m,index:d+1,active:n.value===o};if(r.length===0)r.push(p);else{let g=r[r.length-1];if(p.level>g.level)for(let h=g.level+1;h<=6;h++){const{children:b}=g;if(!b){g.children=[p];break}if(g=b[b.length-1],p.level<=g.level){b.push(p);break}}else r.push(p)}}),r}),a=()=>i.scrollElement instanceof HTMLElement?i.scrollElement:document.querySelector(i.scrollElement),c=Z(r=>{if(r.length===0)return i.list=[],!1;const{activeHead:o}=r.reduce((d,m,k)=>{const p=document.getElementById(e.mdHeadingId(m.text,m.level,k+1));if(p instanceof HTMLElement){const g=a(),h=ye(p,g);if(h<e.offsetTop&&h>d.minTop)return{activeHead:m,minTop:h}}return d},{activeHead:r[0],minTop:Number.MIN_SAFE_INTEGER});n.value=o,i.list=r}),u=()=>{c(i.list)};return T(()=>{var r;const o=a();(r=o===document.documentElement?window:o)==null||r.addEventListener("scroll",u),S.on(l,{name:"catalogChanged",callback:d=>{c(d)}}),S.emit(l,"pushCatalog")}),V(()=>{var r;const o=a();(r=o===document.documentElement?window:o)==null||r.removeEventListener("scroll",u)}),()=>w("div",{class:`${f}-catalog${e.theme==="dark"?"-dark":""} ${e.class}`},[s.value.map(r=>w(et,{mdHeadingId:e.mdHeadingId,tocItem:r,key:`link-${r.level}-${r.text}`,scrollElement:i.scrollElement,onClick:(o,d)=>{e.onClick?e.onClick(o,d):t.emit("onClick",o,d)},scrollElementOffsetTop:e.scrollElementOffsetTop},null))])}}),B=nt;B.install=e=>(e.component(B.name,B),e);export{B as I,A as R};
